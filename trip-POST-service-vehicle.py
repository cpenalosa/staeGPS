import os
import json
from geojson import LineString
import time
import threading
import urllib
import urllib2
import requests
         


url = 'https://municipal.systems/v1/data?key=6c6ea0b1-2d92-4f19-b131-ba564b7e89ef' #keyData= is your Data Source Key. Generate this on the Source Page.

         
os.system('clear') #clear the terminal (optional)
         
if __name__ == '__main__':
            while True:
              #It may take a second or two to get good data
         
              os.system('clear')
	     
              path = LineString([(-74.049845372, 40.72166912),
 (-74.054978076, 40.729354797),
 (-74.054834992, 40.73019391),
 (-74.053199203, 40.731455945),
 (-74.053199203, 40.731455945),
 (-74.052991067, 40.731599976),
 (-74.052802445, 40.731675989),
 (-74.044956908, 40.730670293),
 (-74.050638914, 40.719423196),
 (-74.050905235, 40.724606431),
 (-74.052979685, 40.731598362),
 (-74.052979685, 40.731598362),
 (-74.049908645, 40.723666031),
 (-74.055145557, 40.729856019),
 (-74.053199203, 40.731455945),
 (-74.046101621, 40.730733119),
 (-74.051140659, 40.731071785),
 (-74.043923718, 40.73479005),
 (-74.043860249, 40.735092202),
 (-74.041776922, 40.736423226),
 (-74.037498455, 40.736619237),
 (-74.03956366, 40.736763483),
 (-74.04155251, 40.736475808),
 (-74.053199203, 40.731455945),
 (-74.054571583, 40.720801851),
 (-74.052991067, 40.731599976),
 (-74.044875602, 40.7306832),
 (-74.029419923, 40.735898467),
 (-74.030169576, 40.735880579),
 (-74.054571583, 40.720801851),
 (-74.054582964, 40.720803465),
 (-74.054423618, 40.727987458),
 (-74.053261083, 40.726788282),
 (-74.028752344, 40.738596327),
 (-74.028894413, 40.736695484),
 (-74.028929665, 40.738428193),
 (-74.028942734, 40.738308225),
 (-74.028970288, 40.738519112),
 (-74.054685388, 40.720858939),
 (-74.049287664, 40.722404901),
 (-74.049211213, 40.722943038),
 (-74.05199128, 40.725588949),
 (-74.053679033, 40.720499253),
 (-74.047367999, 40.718537886),
 (-74.051583343, 40.721977722),
 (-74.043922099, 40.734764661),
 (-74.028445149, 40.73818551),
 (-74.049624255, 40.721765672),
 (-74.050383502, 40.721834895),
 (-74.050269561, 40.724013623),
 (-74.053605718, 40.731114757),
 (-74.046597438, 40.718285944),
 (-74.044578016, 40.730832859),
 (-74.044291608, 40.732297689),
 (-74.044075116, 40.733754818),
 (-74.054582964, 40.720810289),
 (-74.054381362, 40.722313004),
 (-74.050266309, 40.724019272),
 (-74.028493934, 40.738118097),
 (-74.05064379, 40.719449757),
 (-74.047343619, 40.718536574),
 (-74.053244955, 40.720344286),
 (-74.051372106, 40.719718684),
 (-74.054571583, 40.720801851),
 (-74.035231665, 40.736233668),
 (-74.043536472, 40.736161535),
 (-74.031101478, 40.735512727), 
 (-74.054215538, 40.720696043),
 (-74.041224018, 40.736524416),
 (-74.03584471, 40.736327833),
 (-74.033164932, 40.735862394),
 (-74.028588364, 40.737642232),
 ])
              startedAt = '2018-01-22T09:45:00.000Z'
              endedAt = '2018-01-22T10:45:00.000Z'
              routeId = 'Downtown Emergency Vehicle Route 4'
              vehicleId = 'Snow Plow 10' 
              type = 'Snow Plow'
              id = 'Plow Trip Alpha'

              payload = {'path':path, 'startedAt':startedAt, 'endedAt':endedAt, 'routeId':routeId, 
              'vehicleId':vehicleId, 'type':type, 'id':id}

              r = requests.post(url, json=payload)
              print r.content #200 = successful http request. 400 = bad request; check your syntax.  500 = server error, check stae status page.  
         
              time.sleep(30) #loop is extra, only need once.
         
          except (KeyboardInterrupt, SystemExit): #press ctrl+c to stop the program
            print "\nStopping GPS program..."
          print "Done.\nExiting."